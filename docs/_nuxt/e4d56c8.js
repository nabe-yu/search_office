(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{260:function(e,t,n){"use strict";n.r(t);n(41),n(42),n(30),n(43),n(44);var r=n(8),f=(n(55),n(31),n(67),n(13),n(28),n(32),n(252),n(179),n(254),n(36),n(259)),c=n(251);function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var f,c=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){o=!0,f=e},f:function(){try{c||null==n.return||n.return()}finally{if(o)throw f}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var d={data:function(){return{offices:[],staffs:[],data:[],isUpload:"",staff_data_file:null,office_data_file:null,columns:[{field:"id",label:"ID"},{field:"home_address",label:"自宅"},{field:"current_office_address",label:"現在の勤務地"},{field:"satellite_office_name",label:"最寄りオフィス"},{field:"satellite_office_distance",label:"最寄りオフィスまでの距離"}]}},computed:{},methods:{downloadCsv:function(){var e="ID,自宅住所,現在の勤務地,最寄りオフィス,自宅から最寄りオフィスまでの距離\n";this.data.forEach((function(t){var line="".concat(t.id,",").concat(t.home_address,",").concat(t.current_office_address,",").concat(t.satellite_office_name,",").concat(t.satellite_office_distance,"\n");e+=line}));var t=new Blob([e],{type:"text/csv"}),link=document.createElement("a");link.href=window.URL.createObjectURL(t),link.download="Result.csv",link.click()},upload:function(){this.uploadStaffData(),this.uploadOfficeData(),this.isUpload=!0},btn:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,f,c,l,d,_,v,h,m,C,y;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<e.offices.length)){t.next=8;break}return t.next=4,e.getCoordinates(e.offices[n].office_address);case 4:e.offices[n].coordinates=t.sent;case 5:n++,t.next=1;break;case 8:e.data=[],r=o(e.staffs),t.prev=10,r.s();case 12:if((f=r.n()).done){t.next=29;break}return c=f.value,t.next=16,e.getCoordinates(c.home_address);case 16:if(!((l=t.sent).length<2)){t.next=21;break}return d={id:c.id,home_address:c.home_address,current_office_address:c.current_office_address,satellite_office_name:"計算不能",satellite_office_distance:-1},e.data.push(d),t.abrupt("continue",27);case 21:_=[],v=o(e.offices);try{for(v.s();!(h=v.n()).done;)m=h.value,_.push({name:m.office_name,dis:e.getDistance(l,m.coordinates)})}catch(e){v.e(e)}finally{v.f()}C=_.sort((function(a,b){if(a.dis<b.dis)return-1})),y={id:c.id,home_address:c.home_address,current_office_address:c.current_office_address,satellite_office_name:C[0].name,satellite_office_distance:C[0].dis},e.data.push(y);case 27:t.next=12;break;case 29:t.next=34;break;case 31:t.prev=31,t.t0=t.catch(10),r.e(t.t0);case 34:return t.prev=34,r.f(),t.finish(34);case 37:case"end":return t.stop()}}),t,null,[[10,31,34,37]])})))()},uploadOfficeData:function(){var e=this;this.offices="";var t=this.office_data_file,n=new FileReader;return n.onload=function(){e.offices=JSON.parse(n.result).offices},n.readAsText(t)},uploadStaffData:function(){var e=this;this.staffs="";var t=this.staff_data_file,n=new FileReader;return n.onload=function(){e.staffs=JSON.parse(n.result).staffs},n.readAsText(t)},getDistance:function(e,t){var n=Object(f.a)(Object(c.c)(e),Object(c.c)(t),{units:"kilometers"});return Math.round(100*n)/100},getCoordinates:function(address){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="https://msearch.gsi.go.jp/address-search/AddressSearch?q=".concat(address),t.next=3,e.$axios.$get(n);case 3:if(!((r=t.sent).length>0)){t.next=8;break}return t.abrupt("return",r[0].geometry.coordinates);case 8:return t.abrupt("return",[]);case 9:case"end":return t.stop()}}),t)})))()}}},_=n(22),component=Object(_.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"section"},[n("div",{staticClass:"content box"},[n("h2",{staticClass:"title is-5"},[e._v("\n      ファイルをアップロードしましょう\n    ")]),e._v(" "),n("p",{staticClass:"subtitle is-6"},[e._v("\n      JSON形式に対応しています。\n    ")]),e._v(" "),n("b-field",{staticClass:"file is-primary",class:{"has-name":!!e.staff_data_file}},[n("b-upload",{staticClass:"file-label",model:{value:e.staff_data_file,callback:function(t){e.staff_data_file=t},expression:"staff_data_file"}},[n("span",{staticClass:"file-cta"},[n("b-icon",{staticClass:"file-icon",attrs:{icon:"upload"}}),e._v(" "),n("span",{staticClass:"file-label"},[e._v("個人情報")])],1),e._v(" "),e.staff_data_file?n("span",{staticClass:"file-name"},[e._v("\n          "+e._s(e.staff_data_file.name)+" ("+e._s(e.staffs.length)+")\n        ")]):e._e()])],1),e._v(" "),n("b-field",{staticClass:"file is-primary",class:{"has-name":!!e.office_data_file}},[n("b-upload",{staticClass:"file-label",model:{value:e.office_data_file,callback:function(t){e.office_data_file=t},expression:"office_data_file"}},[n("span",{staticClass:"file-cta"},[n("b-icon",{staticClass:"file-icon",attrs:{icon:"upload"}}),e._v(" "),n("span",{staticClass:"file-label"},[e._v("オフィス情報")])],1),e._v(" "),e.office_data_file?n("span",{staticClass:"file-name"},[e._v("\n          "+e._s(e.office_data_file.name)+" ("+e._s(e.offices.length)+")\n        ")]):e._e()])],1)],1),e._v(" "),n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[e.office_data_file&&e.staff_data_file?n("div",[n("b-button",{staticClass:"is-large",attrs:{type:"is-info",expanded:"",outlined:""},on:{click:function(t){return e.upload()}}},[e._v("\n          ファイルを読み込む\n        ")])],1):e._e()]),e._v(" "),n("div",{staticClass:"column"},[e.isUpload?n("b-button",{staticClass:"is-large",attrs:{type:"is-danger",expanded:"",outlined:""},on:{click:function(t){return e.btn()}}},[e._v("\n        計算する\n      ")]):e._e()],1),e._v(" "),n("div",{staticClass:"column"},[e.data.length>0&&e.data.length>=e.staffs.length?n("b-button",{staticClass:"is-large",attrs:{type:"is-dark",expanded:"",outlined:""},on:{click:function(t){return e.downloadCsv()}}},[e._v("\n        結果をCSVで保存する\n      ")]):e._e()],1)]),e._v(" "),e.isUpload?n("b-progress",{attrs:{type:"is-info","show-value":"",size:"is-large",value:e.data.length/e.staffs.length*100,rounded:!1,format:"percent"}}):e._e()],1)}),[],!1,null,null,null);t.default=component.exports}}]);